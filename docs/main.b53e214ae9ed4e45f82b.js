!function(t){function e(e){for(var s,o,c=e[0],r=e[1],l=e[2],d=0,m=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&m.push(a[o][0]),a[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);for(u&&u(e);m.length;)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,c=1;c<n.length;c++){var r=n[c];0!==a[r]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},a={0:0},i=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=r;i.push([121,1]),n()}({121:function(t,e,n){n(122),t.exports=n(309)},308:function(t,e,n){},309:function(t,e,n){"use strict";n.r(e),n.d(e,"firebase",(function(){return W}));n(308);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=function t(e,n,i){s(this,t),a(this,"items",void 0),a(this,"listName",void 0),this.listName=e,this.items={},n&&(this.items.toBuy=n),i&&(this.items.purchased=i)},o=function t(e){s(this,t),a(this,"itemName",void 0),a(this,"quantity",1),a(this,"unit","pcs"),this.itemName=e};function c(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}var l={lists:function(t){var e=C.user.uid;O.innerHTML="";var n=U("button","add-list-btn");n.innerHTML="+",O.append(n),n.addEventListener("click",(function(n){n.preventDefault(),b.classList.add("modal_is-open"),g.focus(),y.addEventListener("submit",(function n(s){if(s.preventDefault(),g.value.trim()){var a=g.value.replace(/\s+/g," ").trim(),o=new i(a);t.unshift(o),W.database().ref("".concat(e,"/lists")).set(t),g.value="",y.removeEventListener("submit",n),b.classList.remove("modal_is-open")}}))})),t.forEach((function(n,s){var a=U("div","list-elem"),i=n.items||{},o=i.toBuy||[],c=i.purchased||[],r=o.length||0,u=c.length||0,d=u+r,m='\n        <h2 class="list-elem__name">'.concat(n.listName,'</h2>\n        <span class="list-elem__counter">').concat(u," / ").concat(d,'</span>\n        <div class="list-elem__options">\n          <img src="./img/dots.svg" alt="" />\n    \n          <div class="list-elem__options-list">\n            <a href="#" class="list-elem__options-list-elem">Rename</a>\n            <a href="#" class="list-elem__options-list-elem">Delete</a>\n          </div>\n        </div>\n        <div class="list-elem__progress">\n          <div class="list-elem__progress_blue"></div>\n        </div>\n      ');a.innerHTML=m;var f=a.querySelector(".list-elem__progress_blue"),p=a.querySelector(".list-elem__options"),v=a.querySelector(".list-elem__options-list"),_=v.firstElementChild,h=v.lastElementChild;f.style.width=100*(u/d||1)+"%",B(p,v,"list-elem__options-list"),O.insertAdjacentElement("beforeend",a),_.addEventListener("click",(function(t){function a(t){t.preventDefault(),n.listName!==E.value&&W.database().ref("".concat(e,"/lists/").concat(s,"/listName")).set(E.value),L.classList.remove("modal_is-open"),S.removeEventListener("submit",a)}t.preventDefault(),v.classList.remove("list-elem__options-list_is-open"),L.classList.add("modal_is-open"),E.value=n.listName,S.addEventListener("submit",a),q.addEventListener("click",(function(){L.classList.remove("modal_is-open"),S.removeEventListener("submit",a)})),L.addEventListener("click",(function(t){t.target.classList.contains("modal")&&(L.classList.remove("modal_is-open"),S.removeEventListener("submit",a))}))})),h.addEventListener("click",(function(a){a.preventDefault(),v.classList.remove("list-elem__options-list_is-open"),t.splice(s,1),W.database().ref("".concat(e,"/lists")).set(t),W.database().ref("".concat(e,"/trash")).get().then((function(t){var s=t.val()||[];s.unshift(n),W.database().ref("".concat(e,"/trash")).set(s)}))})),a.addEventListener("click",(function(t){t.target.closest(".list-elem__options")||(O.className="content list",l.list(s))}))}))},list:function(t){var e=C.user.uid;W.database().ref("".concat(e,"/lists")).off(),O.innerHTML='\n    <input type="text" class="shoplist__name">\n    <form class="shoplist__add-item">\n      <label class="shoplist__add-input-label" for="add-item">+</label>\n      <input type="text" name="add-item" id="add-item" class="shoplist__add-input" placeholder="Add item" />\n    </form>\n    <ul class="shoplist__to-buy"></ul>\n    <ul class="shoplist__purchase"></ul>\n  ';var n=O.querySelector(".shoplist__add-item"),s=n.querySelector(".shoplist__add-input");n.addEventListener("submit",(function(n){n.preventDefault(),s.value.trim()&&W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).get().then((function(n){var a=n.val()||[],i=new o(s.value.replace(/\s+/g," ").trim());a.unshift(i),W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(a),s.value="",s.focus()}))})),W.database().ref("".concat(e,"/lists/").concat(t)).on("value",(function(n){var s=n.val(),a=s.listName,i=s.items,o=(null==i?void 0:i.toBuy)||[],r=(null==i?void 0:i.purchased)||[],l=O.querySelector(".shoplist__name"),u=O.querySelector(".shoplist__to-buy");l.value=a,l.addEventListener("change",(function(){W.database().ref("".concat(e,"/lists/").concat(t,"/listName")).set(l.value)})),u.innerHTML="",o.length&&o.forEach((function(n,s){var a=U("li","shoplist__item");a.innerHTML='\n              <div class="shoplist__item-name">\n                <input class="checkbox" type="checkbox" name="add-item-'.concat(s,'" id="add-item-').concat(s,'" />\n                <label class="checkbox__label" for="add-item-').concat(s,'"></label>\n                <span class="shoplist__item-name-text">').concat(n.itemName,'</span>\n                <button class="drop">\n                  <span></span>\n                </button>\n              </div>\n              <div class="shoplist__item-info">\n                <button class="shoplist__item-quantity-btn shoplist__item-quantity-btn_minus">-</button>\n                <input type="number" max="99999" class="shoplist__item-quantity" value="').concat(n.quantity,'">\n                <button class="shoplist__item-quantity-btn shoplist__item-quantity-btn_plus">+</button>\n                <select name="unit-').concat(s,'" id="unit-').concat(s,'" class="shoplist__item-unit">\n                  <option value="pcs">pcs</option>\n                  <option value="kg">kg</option>\n                  <option value="gr">gr</option>\n                  <option value="lit">lit</option>\n                </select>\n                <button class="shoplist__item-delete">\n                  <img src="./img/trash.svg" alt="" class="shoplist__item-delete-img" />\n                </button>\n              </div>\n            ');var i=a.querySelector("#add-item-".concat(s)),l=a.querySelector(".shoplist__item-name-text"),d=a.querySelector(".shoplist__item-quantity"),m=a.querySelector(".shoplist__item-quantity-btn_minus"),f=a.querySelector(".shoplist__item-quantity-btn_plus"),p=c(a.querySelectorAll("option")),v=a.querySelector(".shoplist__item-unit"),_=a.querySelector(".shoplist__item-delete");i.addEventListener("change",(function(){o.splice(s,1),W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(o),r.unshift(n),W.database().ref("".concat(e,"/lists/").concat(t,"/items/purchased")).set(r)})),l.addEventListener("click",(function a(){l.removeEventListener("click",a),l.innerHTML='<input type="text" class="shoplist__item-name-text-input" value="'.concat(n.itemName,'">');var i=l.querySelector(".shoplist__item-name-text-input");function o(){l.innerHTML="",l.innerHTML=n.itemName,l.addEventListener("click",a)}i.focus(),i.addEventListener("change",(function(){var n=i.value.replace(/\s+/g," ").trim();W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy/").concat(s,"/itemName")).set(n)})),i.addEventListener("keydown",(function(t){13===t.keyCode&&i.value===n.itemName&&o()})),i.addEventListener("blur",o)})),d.addEventListener("focus",(function(){d.select()})),d.addEventListener("change",(function(){var n=+d.value;n>0?(Number.isInteger(n)||(n=+n.toFixed(1)),n>9999.9&&(n=9999)):n=1,W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy/").concat(s,"/quantity")).set(n)})),m.addEventListener("click",(function(n){if(n.preventDefault(),+d.value>1){var a=(+d.value-1).toString();new Set(c(a)).has(".")&&(a=(+a).toFixed(1)),W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy/").concat(s,"/quantity")).set(a)}})),f.addEventListener("click",(function(n){n.preventDefault();var a=(+d.value+1).toString();new Set(c(a)).has(".")&&(a=(+a).toFixed(1)),+a<9999&&W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy/").concat(s,"/quantity")).set(a)})),p.forEach((function(t){t.innerHTML===n.unit&&t.setAttribute("selected","selected")})),v.addEventListener("change",(function(n){var a=n.target.value;W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy/").concat(s,"/unit")).set(a)})),_.addEventListener("click",(function(n){n.preventDefault(),o.splice(s,1),W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(o)})),u.insertAdjacentElement("beforeend",a)}));var d=O.querySelector(".shoplist__purchase");d.innerHTML="",r.length&&r.forEach((function(n,s){var a=U("li","shoplist__item shoplist__item_purchase"),i=o.length+s;a.innerHTML='\n              <div class="shoplist__item-name">\n                <input class="checkbox" type="checkbox" checked name="add-item-'.concat(i,'" id="add-item-').concat(i,'" />\n                <label class="checkbox__label" for="add-item-').concat(i,'"></label>\n                <span class="shoplist__item-name-text">').concat(n.itemName,'</span>\n              </div>\n              <div class="shoplist__item-info">\n                <span class="shoplist__item-quantity_purchase">').concat(n.quantity,'</span>\n                <span class="shoplist__item-unit">').concat(n.unit,'</span>\n                <button class="shoplist__item-delete">\n                  <img src="./img/trash.svg" alt="" class="shoplist__item-delete-img" />\n                </button>\n              </div>\n            ');var c=a.querySelector("#add-item-".concat(i)),l=a.querySelector(".shoplist__item-delete");c.addEventListener("change",(function(){r.splice(s,1),W.database().ref("".concat(e,"/lists/").concat(t,"/items/purchased")).set(r),o.push(n),W.database().ref("".concat(e,"/lists/").concat(t,"/items/toBuy")).set(o)})),l.addEventListener("click",(function(n){n.preventDefault(),r.splice(s,1),W.database().ref("".concat(e,"/lists/").concat(t,"/items/purchased")).set(r)})),d.insertAdjacentElement("beforeend",a)}))}))},trash:function(t){var e=C.user.uid;O.innerHTML="",t.forEach((function(n,s){var a=U("div","list-elem"),i=n.items||{},o=i.toBuy||[],c=i.purchased||[],r=o.length||0,l=c.length||0,u=l+r,d='\n        <h2 class="list-elem__name">\n        '.concat(n.listName,'\n        </h2>\n        <span class="list-elem__counter">').concat(l," / ").concat(u,'</span>\n        <div class="trash-btns">\n          <button class="trash-btn">restore</button>\n          <button class="trash-btn">delete</button>\n        </div>\n      ');a.innerHTML=d;var m=a.querySelector(".trash-btns"),f=m.firstElementChild,p=m.lastElementChild;O.insertAdjacentElement("beforeend",a),f.addEventListener("click",(function(a){a.preventDefault(),t.splice(s,1),W.database().ref("".concat(e,"/trash")).set(t),W.database().ref("".concat(e,"/lists")).get().then((function(t){var s=t.val()||[];s.unshift(n),W.database().ref("".concat(e,"/lists")).set(s)}))})),p.addEventListener("click",(function(n){n.preventDefault(),t.splice(s,1),W.database().ref("".concat(e,"/trash")).set(t)}))}))},settings:function(){O.innerHTML="",O.innerHTML='\n      <div class="settings__acc">\n        <div class="settings__acc-info">\n          <div class="settings__acc-name">'.concat(C.user.displayName,'</div>\n          <div class="settings__acc-email">').concat(C.user.email,'</div>\n        </div>\n        <div class="settings__acc-text">Change your name:</div>\n        <div class="settings__acc-name-change-wrapper">\n          <input type="text" name="acc-name" id="acc-name" class="settings__acc-name-change" \n          value="').concat(C.user.displayName,'"/>\n        </div>\n      </div>\n  ');var t=O.querySelector(".settings__acc-name-change"),e=O.querySelector(".settings__acc-name");t.addEventListener("change",(function(n){n.preventDefault(),C.user.updateProfile({displayName:t.value}).then((function(){e.innerHTML=t.value,C.updateUserInfo()}))}))},helloScreen:function(){O.innerHTML='\n    <section class="hello">\n      <p class="hello__text">Здравствуйте, этот проект создан с применением:</p>\n      <h3 class="hello__technologies">\n        TypeScript, Webpack 4, Gulp, SCSS, Git, БЭМ, Firebase (Authentication, Realtime Database).\n      </h3>\n      <p class="hello__text">\n        Для того, чтобы оценить функционал, пожалуйста, авторизируйтесь или нажмите кнопку ниже. Спасибо за внимание.\n      </p>\n      <button class="hello__btn">Try with test account</button>\n    </section>\n  ',O.querySelector(".hello__btn").addEventListener("click",(function(t){t.preventDefault(),W.auth().signInWithEmailAndPassword("testtest@test.test","testtest@test.test").catch((function(t){var e=t.message;alert(e),console.log(t)}))}))}},u=/^\w+@\w+\.\w{2,}$/,d=document.querySelector(".header"),m=d.querySelector("#burger-menu__toggle"),f=d.querySelector(".modal-sidebar"),p=d.querySelector(".modal-sidebar__list"),v=d.querySelector(".header__authorization"),_=d.querySelector(".user"),h=document.querySelector(".sidebar"),b=document.querySelector(".modal-new-list"),y=b.querySelector(".modal__form"),g=b.querySelector(".modal__input"),L=document.querySelector(".modal-rename-list"),S=L.querySelector(".modal__form"),E=L.querySelector(".modal__input"),q=L.querySelector(".modal__btns").firstElementChild,k=document.querySelector(".authorization"),w=k.querySelector(".authorization__form"),N=w.querySelector(".authorization__close"),x=w.querySelector(".authorization__forget"),T=w.querySelector(".authorization__input-email"),M=w.querySelector(".authorization__input-pass"),D=w.querySelector(".authorization__btn_sign-up"),A=w.querySelector(".authorization__btn_sign-in"),H=document.querySelector(".log-out"),j=document.querySelector(".log-out__email"),z=H.querySelector(".log-out__btn"),I=H.querySelector(".log-out__close-btn"),O=document.querySelector(".content");function U(t,e){var n=document.createElement(t);return n.className=e,n}function B(t,e,n){t.addEventListener("click",(function s(){e.classList.add("".concat(n,"_is-open")),t.removeEventListener("click",s),setTimeout((function(){document.addEventListener("click",(function a(i){var o=i.target;o===e||o.closest(".".concat(n))&&!o.classList.contains("".concat(n,"__close-btn"))||(e.classList.remove("".concat(n,"_is-open")),document.removeEventListener("click",a),t.addEventListener("click",s))}))}))}))}function P(){var t=C.user.uid;W.database().ref("".concat(t,"/lists")).get().then((function(e){e.val().forEach((function(e,n){W.database().ref("".concat(t,"/lists/").concat(n)).off()}))}))}var C={user:null,initUser:function(){var t=this;W.auth().onAuthStateChanged((function(){if(t.user=W.auth().currentUser,C.user?(v.style.display="none",_.style.display="",k.classList.remove("authorization_is-open")):(v.style.display="",_.style.display="none"),t.user){t.user.displayName&&t.updateUserInfo();var e=C.user.uid;O.classList.add("lists"),W.database().ref("".concat(e,"/lists")).on("value",(function(t){var e=t.val()||[];O.classList.contains("lists")&&l.lists(e)}))}else O.className="content",l.helloScreen()}))},signIn:function(t,e){if(!u.test(t))return alert("Email is not valid");W.auth().signInWithEmailAndPassword(t,e).catch((function(t){var e=t.code,n=t.message;"auth/wrong-password"===e?alert("Wrong password"):"auth/user-not-found"==e?alert("User not found"):alert(n)}))},signUp:function(t,e){var n=this;return u.test(t)?t.trim()&&e.trim()?void W.auth().createUserWithEmailAndPassword(t,e).then((function(){var e=t.substring(0,t.indexOf("@"));W.auth().currentUser.updateProfile({displayName:e}).then((function(){n.updateUserInfo()}))})).catch((function(t){var e=t.code,n=t.message;"auth/weak-password"===e?alert("Слабый пароль"):"auth/email-already-in-use"==e?alert("Этот email уже используется"):alert(n)})):alert("Введите даные"):alert("email is not valid")},logOut:function(){W.auth().signOut()},sendForget:function(t){if(!u.test(t))return alert("email is not valid");W.auth().sendPasswordResetEmail(t).then((function(){alert("Письмо отправлено")})).catch((function(t){"auth/user-not-found"==t.code?alert("User not found"):alert(t.message)}))},updateUserInfo:function(){_.innerHTML=this.user.displayName[0].toUpperCase(),j.innerHTML=this.user.email}},W=window.firebase;W.initializeApp({apiKey:"AIzaSyBWD1NHPb3KwMzsvX05WLUPqxWMgC2RLTw",authDomain:"buylist-b265a.firebaseapp.com",databaseURL:"https://buylist-b265a-default-rtdb.firebaseio.com",projectId:"buylist-b265a",storageBucket:"buylist-b265a.appspot.com",messagingSenderId:"753800425123",appId:"1:753800425123:web:c4e4e589ba986cf1511916"}),C.initUser(),f.addEventListener("click",(function(t){var e=t.target,n=C.user.uid;e!==p&&(m.checked=!1),O.classList.contains("lists")&&(O.querySelector(".add-list-btn").style.zIndex="2"),e.closest(".sidebar__btn-lists")&&(O.classList.contains("list")&&P(),O.className="content lists",W.database().ref("".concat(n,"/trash")).off(),W.database().ref("".concat(n,"/lists")).on("value",(function(t){var e=t.val()||[];l.lists(e)}))),e.closest(".sidebar__btn-trash")&&(O.classList.contains("list")&&P(),O.className="content trash",W.database().ref("".concat(n,"/lists")).off(),W.database().ref("".concat(n,"/trash")).on("value",(function(t){var e=t.val()||[];l.trash(e)}))),e.closest(".sidebar__btn-settings")&&(O.classList.contains("list")&&P(),W.database().ref("".concat(n,"/trash")).off(),O.className="content settings",l.settings())})),m.addEventListener("change",(function(){O.classList.contains("lists")&&(O.querySelector(".add-list-btn").style.zIndex="0")})),v.addEventListener("click",(function(){k.classList.add("authorization_is-open")})),k.addEventListener("click",(function(t){t.target===k&&k.classList.remove("authorization_is-open")})),N.addEventListener("click",(function(t){t.preventDefault(),t.target===N&&k.classList.remove("authorization_is-open")})),x.addEventListener("click",(function(t){t.preventDefault(),C.sendForget(T.value)})),D.addEventListener("click",(function(t){t.preventDefault(),C.signUp(T.value,M.value)})),B(_,H,"log-out"),z.addEventListener("click",(function(){H.classList.remove("log-out_is-open"),C.logOut()})),I.addEventListener("click",(function(){H.classList.remove("log-out_is-open")})),A.addEventListener("click",(function(t){t.preventDefault(),C.signIn(T.value,M.value)})),b.addEventListener("click",(function(t){t.target.classList.contains("modal")&&(b.classList.remove("modal_is-open"),b.querySelector(".modal__input").value="")})),h.addEventListener("click",(function(t){var e=t.target,n=C.user.uid;e.classList.contains("sidebar")||(e.closest(".sidebar__btn-lists")&&(O.classList.contains("list")&&P(),O.className="content lists",W.database().ref("".concat(n,"/trash")).off(),W.database().ref("".concat(n,"/lists")).on("value",(function(t){var e=t.val()||[];l.lists(e)}))),e.closest(".sidebar__btn-trash")&&(O.classList.contains("list")&&P(),O.className="content trash",W.database().ref("".concat(n,"/lists")).off(),W.database().ref("".concat(n,"/trash")).on("value",(function(t){var e=t.val()||[];l.trash(e)}))),e.closest(".sidebar__btn-settings")&&(O.classList.contains("list")&&P(),W.database().ref("".concat(n,"/lists")).off(),W.database().ref("".concat(n,"/trash")).off(),O.className="content settings",l.settings()))}))}});